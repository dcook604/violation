{% extends 'base.html' %}
{% block title %}New Violation | Strata Violation Log{% endblock %}
{% block content %}
  <div class="violation-box">
    <h3 class="mb-4 text-center">Create New Violation</h3>
    <form method="post" enctype="multipart/form-data">
      {{ form.hidden_tag() }}
      <div class="row mb-3">
        <div class="col">
          {{ form.incident_date.label(class="form-label") }}
          {{ form.incident_date(class="form-control") }}
              <option value="">Select a Category</option>
              {% for cat in categories %}<option>{{ cat }}</option>{% endfor %}
            </select>
          </div>
        </div>
        <div class="row mb-3">
          <div class="col">
            <label class="form-label">Building*</label>
            <input type="text" name="building" class="form-control" value="BCS2611 Spectrum 4 Apartments" readonly>
          </div>
          <div class="col">
            <label class="form-label">Incident Units</label>
            <select name="incident_units" class="form-select" multiple>
              {% for unit in units %}<option>{{ unit }}</option>{% endfor %}
            </select>
            <small class="text-muted">(Hold Ctrl/Cmd to select multiple)</small>
          </div>
        </div>
        <div class="mb-3">
          <label class="form-label">Incident Area</label>
          <input type="text" name="incident_area" class="form-control">
        </div>
        <div class="row mb-3">
          <div class="col">
            <label class="form-label">Report To*</label>
            <select name="report_to" class="form-select" required>
              <option value="">Select a Manager</option>
              {% for mgr in managers %}<option>{{ mgr }}</option>{% endfor %}
            </select>
          </div>
          <div class="col">
            <label class="form-label">Concierge Shift</label>
            <input type="text" name="concierge_shift" class="form-control">
          </div>
        </div>
        <div class="row mb-3">
          <div class="col">
            <label class="form-label">Time*</label>
            <input type="time" name="incident_time" class="form-control" required>
          </div>
          <div class="col">
            <label class="form-label">People Involved</label>
            <input type="text" name="people_involved" class="form-control">
          </div>
        </div>
        <div class="row mb-3">
          <div class="col">
            <label class="form-label">Noticed By</label>
            <input type="text" name="noticed_by" class="form-control">
          </div>
          <div class="col">
            <label class="form-label">People Called</label>
            <input type="text" name="people_called" class="form-control">
          </div>
        </div>
        <div class="mb-3">
          <label class="form-label">Re: (Subject)</label>
          <input type="text" name="subject" class="form-control">
        </div>
        <div class="mb-3">
          <label class="form-label">Details*</label>
          <textarea name="details" class="form-control" rows="3" required></textarea>
        </div>
        <div class="mb-3">
          <label class="form-label">Initial Action Taken</label>
          <textarea name="initial_action" class="form-control" rows="2"></textarea>
        </div>
        <div class="mb-3">
          <label class="form-label">Resolution</label>
          <textarea name="resolution" class="form-control" rows="2"></textarea>
        </div>
        <div class="mb-3">
          <label class="form-label">Upload Photos</label>
          <input type="file" name="photos" class="form-control" accept="image/jpeg,image/gif" multiple>
          <small class="text-muted">(jpg or gif only)</small>
        </div>
        <div class="mb-3">
          <label class="form-label">Upload PDFs</label>
          <input type="file" name="pdfs" class="form-control" accept="application/pdf" multiple>
        </div>
        {% if custom_fields %}
        <div class="mb-3">
          <label class="form-label">Additional Information</label>
        </div>
        {% for field in custom_fields %}
        <div class="mb-3">
          <label class="form-label">{{ field.label }}</label>
          <input type="{{ field.type }}" name="custom_{{ field.name }}" class="form-control">
        </div>
        {% endfor %}
      {% endif %}
      <button type="submit" class="btn btn-primary w-100">Submit Violation</button>
      <a href="/" class="btn btn-link mt-2">Cancel</a>
    </form>
  </div>
{% endblock %}
